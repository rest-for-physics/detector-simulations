<?xml version="1.0" encoding="UTF-8" standalone="no" ?>

<!-- Constructing XML-like REST metadata input file
     File : config.rml
     First concept author J. Galan (26-Apr-2015)
     Second concept author G. Luzon (March-2017)
     Adapted for IAXOD0 by E. Ruiz-ChÃ³liz (April-2017) -->

<!-- Any commented text will just not end up in the configBuffer inside TRestMetadata 
     We can comment out pieces of configuration using XML commenting style.
     
     By default REST units are mm, keV and degrees -->

<!-- Environmental variables -->

<environment>
    <variable name="EXPERIMENT" value="IAXOD0" overwrite="false" />
    <variable name="VERSION" value="1.0" overwrite="false" />
    <variable name="IAXOD0_PATH" value="${HOME}/IAXOD0-REST/" overwrite="true" />
    <variable name="IAXOD0_DATAPATH" value="${HOME}/REST_v2_data/IAXOD0" overwrite="true" />
    <variable name="IAXOD0_G4PATH" value="${IAXOD0_PATH}/G4sims/" overwrite="true" />
    <variable name="IAXOD0_GEOPATH" value="${IAXOD0_G4PATH}/geometry" overwrite="true" />
    <variable name="IAXOD0_GEODIR" value="Argon" overwrite="true" />   <!-- options "Argon" or "Xenon" -->
    <variable name="IAXOD0_GAS" value="Argon-Isobutane 2Pct 10-10E3V/cm" overwrite="true" />  <!-- options "Argon-Isobutane 2Pct 10-10E3V/cm", "Xenon-Isobutane 2Pct 10-10E3V/cm" or any other gas in gases.rml file-->
    <variable name="DIR_DATA" value="Muons" overwrite="true" />
</environment>

<!-- Global parameters -->

<globals>
    <parameter name="mainDataPath" value="${IAXOD0_DATAPATH}/${IAXOD0_GEODIR}/${DIR_DATA}" />
    <parameter name="gasDataPath" value="${REST_PATH}/inputData/gasFiles/" />
    <parameter name="verboseLevel" value="warning" /> %options are : silent, warning, info, debug
</globals>

<!-- Run information -->

<section TRestRun name="Background Model" title="Simulations ${EXPERIMENT}. Version ${VERSION}.">
    <parameter name="experiment" value="${EXPERIMENT}"/>
    <parameter name="runType" value="Track_analysis"/>
    <parameter name="readOnly" value="false" />
    <parameter name="runNumber" value="same"/>
    <parameter name="runTag" value="Muons_ArIso"/>
    <parameter name="runDescription" value="We launch Muons from a virtual Wall"/>
    <parameter name="user" value="${USER}"/>
    <parameter name="verboseLevel" value="3"/>
    <parameter name="overwrite" value="off" />
    <parameter name="outputFile" value="Run_[RUNTYPE]_[RUNTAG]_[RUN]_Version_[VERSION].root" />
</section>

<!-- Process manager -->

<section TRestManager name="restSimAnalysis" title="restSimAnalysis">
    <parameter name="inputFile" value="${IAXOD0_DATAPATH}/${IAXOD0_GEODIR}/${DIR_DATA}/Run_simulation_Muons_ArIso_00021_Version_2.1.6.root">
    <parameter name="firstEntry" value="0" >
    <parameter name="lastEntry" value="0" >
    <parameter name="eventsToProcess" value="1000000" >
    <parameter name="pureAnalysisOutput" value="OFF" >
    
    <!-- Setting source config files -->
    <parameter name="gasFile" value="${REST_PATH}/inputData/definitions/gases.rml" >
    <parameter name="readoutFile" value="IAXOD0_Readout.root" >
    <parameter name="processesFile" value="${IAXOD0_G4PATH}/restProcesses/G4processes.rml" >
    <parameter name="tasksFile" value="${IAXOD0_G4PATH}/restPlots/plots.rml" >

    <!-- Adding metadata -->
    <addMetadata type="TRestReadout" name="IAXOD0_Readout" value="ON" overwrite="true" >
    <!-- We can modify/shift the readout plane definition that was prebuilt in a root file here using a sentence like  
    <readoutPlane id="0" planePosition="(-96.75,-96.375,-255)" cathodePosition="(0,0,93)" />
    -->
    <addMetadata type="TRestGas" name="${IAXOD0_GAS}" pressure="1.4" value="ON" overwrite="true" > <!-- gas pressure units in TRestGas is atm -->
    
    <!-- Adding processes -->

    <!-- Geant4 Analysis -->
    <addProcess type="TRestGeant4AnalysisProcess" name="g4Ana" value="ON" >

    <!-- Hits Analysis -->
    <addProcess type="TRestG4toHitsProcess" name="G4ToHits" value="ON" >
    <addProcess type="TRestElectronDiffusionProcess" name="Ar2Iso_electronDiffusion-1kVcm-1.4atm" value="ON" >
    <addProcess type="TRestHitsReductionProcess" name="hitsReduction-Template"  value="ON" >
    <addProcess type="TRestHitsAnalysisProcess" name="hitsAna" value="ON" >

    <!-- Tracks Analysis -->
    <!-- <addProcess type="TRestFastHitsToTrackProcess" name="fastHitsToTrack-Template" value="OFF" > -->
    <addProcess type="TRestHitsToTrackProcess" name="hitsToTrack" value="OFF" >  
    <addProcess type="TRestTrackReductionProcess" name="trackReduction-Template" value="OFF" >
    <addProcess type="TRestTrackPathMinimizationProcess" name="trackPathMinimization-Template" value="OFF" >
    <addProcess type="TRestTrackReconnectionProcess" name="trackReconnection-Template" value="OFF" >
    <addProcess type="TRestTrackAnalysisProcess" name="tckAna" value="OFF" >

    <!-- Signal Analysis -->
    <addProcess type="TRestHitsToSignalProcess" name="hitsToSignal-Template" value="OFF" >
    <addProcess type="TRestSignalShapingProcess" name="signalShapingProcess" value="OFF" >
    <addProcess type="TRestSignalGaussianConvolutionProcess" name="gaussian-Convolution" value="OFF" >
    <addProcess type="TRestAddSignalNoiseProcess" name="addSignalNoiseProcess" value="OFF" >
    <addProcess type="TRestSignalAnalysisProcess" name="sgnlAna" value="OFF" >
            
    <!-- Now we need to define in the manager the tasks we will perform.
         If task processEvents is not enabled processes will not be launched --> 
    <addTask type="processEvents" value="ON" >

    <!-- If analysisPlot is before the processEvents task it will take as input file the input for TRestRun.
         If it is after processEvents it will take the output of TRestRun. -->
    <addTask type="analysisPlot" name="Template" value="OFF" >
</section>




